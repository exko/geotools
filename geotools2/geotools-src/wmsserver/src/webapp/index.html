<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>
  <HEAD>
    <TITLE></TITLE>
  </HEAD>
  <BODY>
    <h1>GeoTools 2 Web Map Server</h1>
    If you can see a map in the area below this text then you have correctly
installed the GT2WMS.<p>
<img src='servlet/gt2wms?request=getMap&layers=USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=green'
width=400 height=200/>
The URL used to generated the map was:<br>
'<a href="servlet/gt2wms?request=getMap&layers=USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=green"/>
servlet/gt2wms?request=getMap&layers=USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=green</a>'<P>
As you can see, a lot of information is passed to your servlet installation to generate the map.  For full details of what all the parts of the
URL mean, take a look through the OpenGIS <a href="http://www.opengis.org/techno/specs/01-068r3.pdf">Web Map Server</A> specification. <p> 

     <p>The map is derived from a shapefile in the <a href="maps"/>maps</A> folder using the <a href="styles/green.sld">green</A> style document. <p>
<p>The styling language is the OpenGIS <a href="http://www.opengis.org/techno/specs/02-070.pdf">Styled Layer Descriptor</a> (SLD).
The one used to make the above map is a very basic one.  The most important part of the file is:
<pre>
&lt;FeatureTypeName&gt;feature&lt;/FeatureTypeName&gt;
&lt;Rule&gt;
    &lt;PolygonSymbolizer&gt;
        &lt;Fill&gt;
          &lt;CssParameter name="fill"&gt;#66FF66&lt;/CssParameter&gt;
        &lt;/Fill&gt;   
        &lt;Stroke/&gt;       
    &lt;/PolygonSymbolizer&gt;
&lt;/Rule&gt;
</pre>
The FeatureTypeName says what sort of features the style applies to.  In this case, it is the rather generic name 
'feature' as this is what all shapes generated by the Shapefile datasource are called.<p>
The next block is a Rule.  For now it is just a wrapper around a symbolizer though, as you will see in later
examples, rules can be used to select which features should be styled.<p>
The next block says that the features should be styled using a PolygonSymbolizer which is handy as the shapes
are indeed polygons.  Inside that you will find a Fill with its colour set to a rather nice shade of green and 
a Stroke with no colour set, so it will default to black.  If you read the SLD spec you will find out about other
options that you can set for fills and strokes, including opacity, patterns and widths.<p>


The following map uses a more advanced style document to shade the states based on their population:<p>
    <img src='servlet/gt2wms?request=getMap&layers=USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=population'
width=400 height=200/> 
<img src='servlet/gt2wms?request=getLegendGraphic&layers=USA&styles=population&width=250&height=100'
width='250' height='100'/>
<p>That map was generated using :<br>
'<a href="servlet/gt2wms?request=getMap&layers=USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=population"/>
servlet/gt2wms?request=getMap&layers=USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=population'</a><br>
using the <a href="styles/popshade.sld">popshade</A> style document. The legend
is drawn using the GetLegendGraphics request <a
href="servlet/gt2wms?request=getLegendGraphic&layers=USA&styles=population&width=250&height=100">servlet/gt2wms?request=getLegendGraphic&layers=USA&styles=population&width=250&height=100</A><p>
This style document adds filters to the rules so that different states are shaded in different colours.  For example:<br>
<pre>
&lt;Rule&gt;
    &lt;name&gt;between 2000000 and 4000000 persons&lt;/name&gt;
    &lt;Filter xmlns:gml="http://www.opengis.net/gml"&gt;
      &lt;PropertyIsBetween&gt;
        &lt;PropertyName&gt;PERSONS&lt;/PropertyName&gt;
        &lt;LowerBoundary&gt;
          &lt;Literal&gt;2000000&lt;/Literal&gt;
        &lt;/LowerBoundary&gt;
        &lt;UpperBoundary&gt;
          &lt;Literal&gt;4000000&lt;/Literal&gt;
        &lt;/UpperBoundary&gt;
      &lt;/PropertyIsBetween&gt;
    &lt;/Filter&gt;
    &lt;PolygonSymbolizer&gt;
       &lt;Fill&gt;
          &lt;CssParameter name="fill"&gt;#FF0000&lt;/CssParameter&gt;
       &lt;/Fill&gt;     
    &lt;/PolygonSymbolizer&gt;
&lt;/Rule&gt;
</pre>
<br>
This checks the value of the PERSONS attribute (a column in the shapefile's dbf) to see if it is between 2000000 and 4000000.  If it is, then the polygon
is filled in red (#ff0000 is the hex value for red).<br>
The filters are very powerful and can include spatial operations as well as mathematical calculations.  For full
details see the OpenGIS <a href="http://www.opengis.org/techno/specs/02-059.pdf">Filter Encoding Specification.</a>

The following shows an example of a spatial operation being embedded in the style document:<p>
 <img src='servlet/gt2wms?request=getMap&layers=USA,USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=normal,bbox'
width=400 height=200/><br>
This image was generated using the following URL<p>
'<a href="servlet/gt2wms?request=getMap&layers=USA,USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=normal,bbox"/>
servlet/gt2wms?request=getMap&layers=USA,USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=normal,bbox</a>
'<br>
which uses the <a href="styles/normal.sld">normal</A> and <a href="styles/usa_central.sld">usa_central</A> style documents.<br>
The interesting part is the following filter in the usa_central document:<br>
<pre>
&lt;Filter  xmlns:gml="http://www.opengis.net/gml"&gt;
    &lt;Not&gt;
       &lt;Disjoint&gt;
            &lt;PropertyName&gt;Polygons&lt;/PropertyName&gt;
            &lt;gml:Box srsName="http://www.epsg.com"&gt;
                &lt;gml:coordinates&gt;-110,37 -95,40&lt;/gml:coordinates&gt;
            &lt;/gml:Box&gt;
        &lt;/Disjoint&gt;
   &lt;/Not&gt;
&lt;/Filter&gt;
&lt;PolygonSymbolizer&gt;
   &lt;Fill&gt;
      &lt;CssParameter name="fill"&gt;#00ff00&lt;/CssParameter&gt;
      &lt;CssParameter name="opacity"&gt;.5&lt;/CssParameter&gt;
   &lt;/Fill&gt;     
&lt;/PolygonSymbolizer&gt;
</pre>
which shades only the polygons which are not disjoint from the specified bounding box with a green fill that is 50% transparent.<p>

Expressions can also be used inside the symbolizers to control their parameters.  For example, line width can be derived from a roads attributes or, as in the following map,
the opacity can be determined from a ratio.<p>
<img src='servlet/gt2wms?request=getMap&layers=USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=manualVsWorkers'
width=400 height=200/><p>
The URL for this map is: '<a href="servlet/gt2wms?request=getMap&layers=USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=manualVsWorkers"/>
servlet/gt2wms?request=getMap&layers=USA,USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=manualVsWorkers'</A><br>
and the style document is <a href="styles/normal.sld">usa_math</A><p>
This time the important information is in the symbolizer:
<pre>
&lt;PolygonSymbolizer&gt;
   &lt;Fill&gt;
      &lt;CssParameter name="fill"&gt;#000000&lt;/CssParameter&gt;
      &lt;CssParameter name="opacity"&gt;
        &lt;Div&gt;
            &lt;PropertyName&gt;MANUAL&lt;/PropertyName&gt;
            &lt;PropertyName&gt;WORKERS&lt;/PropertyName&gt;
        &lt;/Div&gt;
      &lt;/CssParameter&gt;
   &lt;/Fill&gt;
   &lt;stroke/&gt;     
&lt;/PolygonSymbolizer&gt;
</pre>
Note that because the map is semi-transparent it can be combined with another map to produce a combined effect.  For example, the following map uses the same style as above as well as
 another where the colour is determined by the male/female ratio:<p>
<img src='servlet/gt2wms?request=getMap&layers=USA,USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=manualVsWorkers,maleVsFemale'
width=400 height=200/><p>
The URL for this map is: '
<a href="servlet/gt2wms?request=getMap&layers=USA,USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=manualVsWorkers,maleVsFemale">
servlet/gt2wms?request=getMap&layers=USA,USA&bbox=-140,20,-60,60&width=400&height=200&srs=EPSG:4326&styles=manualVsWorkers,maleVsFemale</a>'<br>
and male vs female style document is <a href="styles/usa_ratio.sld">usa_ratio</A>
<p>
By using filters to the full and by using expressions within symbolizers, you should be able to define almost any map you like.  The remainder of this page looks at how you configure the web map server
to show your own maps.<p>

Inside the web application you will find a number of key files.  The most important is the <a href="layers.xml">layers.xml</a> document.  If you take a look you will see that it defines layers, giving their names and a list of styles.<br>
The format of this document is still under development, but from the examples you should see how to set up a shapefile datasource and a postgis datasource.  Other datasources, including GML2, will be supported in a future release.<p>

The capabilities.xml document is a template and you should not need to edit it, except to change some contact details if you want to.<p>
The maps shown in this page are not interactive even though they are generated dynamically by the web map server.  You will need a Web Map Client if you want to pan, zoom or query the maps interactively.
Two good examples, which are known to work with the GT2WMS, are the <a href="http://www.cubewerx.com/main_en/mgb.htm">cubewerx client</a> and the <a href="http://www.wmsviewer.com">intergraph client</a>.
  </BODY>
</HTML>
