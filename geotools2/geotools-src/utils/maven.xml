<?xml version="1.0" encoding="UTF-8"?>

<project default="build"
         xmlns:reactor="reactor"
         xmlns:m="maven"
         xmlns:texen="texen"
         xmlns:j="jelly:core"
         xmlns:u="jelly:util"
         xmlns:deploy="deploy">
         
        <goal name="release">
            <echo>
                  creating release from contents of ${maven.src.dir}
            </echo> 
            <j:set var="sej" value="${sejars}" />
            <deploy:copy-deps todir="${maven.build.dir}/lib"/>

            <mkdir dir="${maven.build.dir}" />
            <u:tokenize var="sej" delim=",">${sej}</u:tokenize>
            <j:forEach items="${sej}" var="jarname" indexVar="jarNumber">

                <jar destfile="${maven.build.dir}/${jarname}.jar">


                    <fileset dir="${maven.src.dir}">
                        
                    </fileset>

                    <metainf dir="${basedir}">
                        <include name="LICENSE.txt"/>
                    </metainf>     
                    <j:set var="mainclass" value="${package}.${jarname}"/>


                    <j:set var="deplist" value="" />
                    <manifest>
                        <attribute name="Built-By" value="${user.name}" />
                        <attribute name="Main-Class" value="${mainclass}" />
                        <j:forEach var="dep" items="${pom.dependencies}">
                            <j:set var="deplist" value="${deplist}lib/${dep.getArtifact()} " />
                        </j:forEach>          
                        <attribute name="Class-Path" value="${deplist}" />            
                    </manifest>

                </jar>
         </j:forEach>
    </goal>
         
</project>